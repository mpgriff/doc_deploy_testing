<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Usage - anEMone</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Usage";
        var mkdocs_page_input_path = "usage.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="index.html">
          <img src="images/logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="index.html">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Usage</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#the-imports">The imports</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#the-configuration">The configuration</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#running-a-forward">Running a forward</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#running-multiple-forwards">Running multiple forwards</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="project_layout.html">Project Layout</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">anEMone</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Usage</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="example-1-quick-start">Example 1 (quick-start)</h2>
<p>Let's walk-through the example we saw in the <a href="quick_start.html">quick start</a>.</p>
<h3 id="the-imports">The imports</h3>
<pre><code class="language-python">from anemone.experiment import Loop, Receiver, Waveform
from anemone.forwards import Forward
import torch
</code></pre>
<ul>
<li>The main user configurable bits are included in the anemone.experiment module. </li>
<li>The forward module contains operators that take the users defined configuration and returns a function that computes <span class="arithmatex">\(dB/dt\)</span> based on resistivity and thickness.</li>
<li>torch is required for tensors (or arrays), for example the set of times for which <span class="arithmatex">\(dB/dt\)</span> is evaluated, or the resistivity values in the 1d earth.</li>
</ul>
<h3 id="the-configuration">The configuration</h3>
<pre><code class="language-python">tx = Loop.square(40)
rx = Receiver() # by default located at x,y,z=(0,0,0)
wv = Waveform.example()# trapezoidal example

t = torch.logspace(-5, -3, 32)

fwr = Forward(tx, rx, t, waveform=wv)
</code></pre>
<p>In this example, we have defined the following TEM system:
- a 40m x 40m transmit loop
- a unit dipole receiver placed at the origin
- trapezoidal example waveform
- set of times at which <span class="arithmatex">\(dB/dt\)</span> is evaluated.</p>
<p>The forward operator takes these configuration parameters and return the function for follow-up simulations of the <span class="arithmatex">\(dB/dt\)</span> response.</p>
<h3 id="running-a-forward">Running a forward</h3>
<p>Now, running the forward is relatively simple:</p>
<pre><code class="language-python">rho   = torch.tensor([40., 80., 40.])
thick = torch.tensor([20., 30.])

dbdt = fwr(rho, thick)
</code></pre>
<p>We define our resistivity values in the layers and the associated thicknesses (last layer extends to infinity) and we can pass these tensors to the forward function to get the response.
We've used 3 layers in the example, but an arbitrary number can used.</p>
<h3 id="running-multiple-forwards">Running multiple forwards</h3>
<p>Instead of the single <span class="arithmatex">\(dB/dt\)</span> response, multiple can be obtained in one function call. The important thing is that the <strong>layers</strong> are indexed along the 0-th dimension:</p>
<pre><code class="language-python">rho = torch.ones((3,10))*40
rho[1, :] = torch.linspace(30, 80, 10) # sweep the middle layer

thick = torch.ones((2,10))*20.
thick[1,:] = 30

dbdts = fwr(rho, thick)
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="quick_start.html" class="btn btn-neutral float-left" title="Quick Start"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="project_layout.html" class="btn btn-neutral float-right" title="Project Layout">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="quick_start.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="project_layout.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="javascripts/mathjax.js"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
